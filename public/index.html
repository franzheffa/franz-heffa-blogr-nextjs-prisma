<!doctype html><html lang="fr"><meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>✅ Front connecté au Gateway</title>
<style>
 body{font-family:system-ui,Segoe UI,Roboto,Arial;margin:32px}
 h1{margin:0 0 8px} .card{border:1px solid #ddd;border-radius:12px;padding:16px;margin:16px 0}
 input,button{padding:8px 10px} .row{display:flex;gap:8px}
 .muted{color:#666;font-size:12px}
</style>
<h1>✅ Front connecté au Gateway</h1>
<div class="muted">Vérifs rapides : <code>/api/health</code> → <span id="h"></span></div>
<div class="card">
  <h3>Tester l'agent d'écho via proxy</h3>
  <div class="row">
    <input id="m" value="Bonjour" style="flex:1"/>
    <button onclick="sendEcho()">Envoyer</button>
  </div>
  <pre id="echoOut"></pre>
</div>

<div class="card">
  <h3>Tester Gemini (texte + image URL optionnelle)</h3>
  <div class="row"><input id="p" placeholder="Ton prompt…" style="flex:1" value="Donne-moi un haïku sur le code."/></div>
  <div class="row"><input id="img" placeholder="https://exemple/image.jpg (optionnel)" style="flex:1"/></div>
  <div class="row"><button onclick="sendGemini()">Générer</button></div>
  <pre id="gemOut"></pre>
</div>

<script>
async function health(){
  try{const r=await fetch('/api/health');document.getElementById('h').textContent = r.ok?'ok':'ko'}
  catch{document.getElementById('h').textContent='ko'}
}
async function sendEcho(){
  const r=await fetch('/api/agents/echo',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({message:document.getElementById('m').value})});
  document.getElementById('echoOut').textContent = await r.text();
}
async function sendGemini(){
  const payload={prompt:document.getElementById('p').value};
  const url=document.getElementById('img').value.trim(); if(url) payload.image_url=url;
  const r=await fetch('/api/agents/gemini',{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify(payload)});
  document.getElementById('gemOut').textContent = await r.text();
}
health();
</script>
